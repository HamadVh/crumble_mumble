{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}
	<script type="text/javascript">
    $(function() {
        $('.inline.{{ ingredient_form.prefix }}').formset({
            prefix: '{{ ingredient_form.prefix }}'
        });
        $('.inline.{{ instruction_form.prefix }}').formset({
            prefix: '{{ instruction_form.prefix }}'
        });
    })
	</script>
	<div class="col-7">
		<form action="." method="POST" enctype="multipart/form-data">
			{% csrf_token %}
			{{form|crispy}}

			<legend class="card-title">Ingredients</legend>
			<div class="inline {{ ingredient_form.prefix }}">
			    {{ ingredient_form.non_form_errors }}
			    {{ ingredient_form.management_form }}

			    {% for form in ingredient_form %}
			    	<div class="row">
				    	<div class="mr-1">
				        	{{ form.measure|as_crispy_field }}
				    	</div>
				    	<div class="mx-1">
				        	{{ form.amount|as_crispy_field }}
				        </div>
				        <div class="mx-1">
				        	{{ form.ingredient|as_crispy_field }}
				        </div>
				    </div>                      
			    {% endfor %}
			</div>


			<legend class="card-title mt-3">Instructions</legend> 
			<div class="inline {{ instruction_form.prefix }}">                    
                {{ instruction_form.non_form_errors }}
                {{ instruction_form.management_form }}

                {% for form in instruction_form.forms %}
                    {{ form.description|as_crispy_field}}
                {% endfor %}
            </div>
			<button type="submit">Add recipe</button>
		</form>
	</div>
{% endblock content %}