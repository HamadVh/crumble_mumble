{% extends "base.html" %}

{% block title %}
{% endblock title %}

{% block content %}
	<div class="card col-lg-8 col-sm-11 m-auto p-0">

		<div class="card-body">
			<div class="row"> 
				<div class="col-lg-6 col-sm-11">
					{% if user == recipe.owner %}
						<a href="{% url 'update-recipe' recipe.slug %}">Edit</a>
					{% else %}
						<button class="btn btn-light" id="save-btn" onclick="save()">
							<i class="far fa-save
										{% if saved %}
											pink-text
										{% else %}
											beige-text
										{% endif %}" ></i>
						</button>
					{% endif %}
					<h3 class="text-center">{{recipe.name}}</h3>
					<p>Recipe by: {{recipe.owner}}</p>
					<p>"{{recipe.description}}"</p>
				</div>
				<div class="col-lg-6 col-sm-11">
					<img src="{{recipe.image.url}}" class="image-crop image-lg col-12">
				</div>
			</div>
		</div>

		<div class="card-header">
		    Ingredients
		</div>
		<div class="card-body">
			<ul>
			{% for measurement in recipe.measurements.all %}
				 <li>{{measurement.amount}} {{measurement.measure}} - {{measurement.ingredient}}</li>
			{% endfor %}
			</ul>
		</div>
		<div class="card-header">
		    Method
		</div>
		<div class="card-body">
			<ol>
			{% for instruction in recipe.instructions.all %}
				 <li>{{instruction.description}}</li>
			{% endfor %}
			</ol>
		</div>
		<a href="{% url 'export-recipe' recipe.slug %}" class="btn btn-outline-dark mx-auto mb-3 col-4">Export</a>
	</div>
	<script type="text/javascript">
	function save() {
	    $.ajax(
	        {
	            type:'GET',
	            url: '{% url "save-recipe" recipe.id %}',
	            error: function(){
	                console.log('error');
	            },
	            success: function(data){
	            	console.log(data)
	            	if (data.saved){
	            		$("#save-btn").addClass("pink-text");
	            		$("#save-btn").removeClass("beige-text");
	            	}else{
	            		console.log("data")
	            		$("#save-btn").addClass("beige-text");
	            		$("#save-btn").removeClass("pink-text");
	            	}
	                
	            },
	        }
	    );
	}
	</script>
{% endblock content %}